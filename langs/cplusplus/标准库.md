# 标准库

C++标准库：Standard Libaray，以header files的形式呈现，C++标准库的80%都是STL。

STL：Standard Template Library 标准模板库，惠普实验室开发。

## STL六大部件：

1. **容器 containers**，如vector、list、deque、set、map，从实现角度来看，STL容器是一种 class template
2. **算法Algorithms**，如sort、find、copy、for_each。从实现的角度来看，STL算法是一泓 function template
3. **迭代器 Iterators**，使容器和算法进行无缝连接，共5种类型，从实现角度来看，迭代器是一种将 operator *、operator->、operator++、operator--等指针相关操作予以重载的 class template。所有 STL 容器都附带有自己专属的迭代器！只有容器的设计者才知道如何遍历自己的元素。原生指针（native pointer)也是一种迭代器。
4. **仿函数 Functors**，行为类似函数，可以作为算法的某种策略。从实现角度来看，仿函数是一种重载了 operator() 的 class 或者 class template
5. **容器适配器 Container Adapters**，一种用来修饰容器或者仿函数或迭代器接口的东西。
6. **分配器 Allocators**，负责内存的配置与管理。从实现角度看，分配器是一个实现了动态内存配置、内存管理、内存释放



![image-20210419220837708](../../images/STL-adapter.png)



stream_iterator:

![image-20210419221156803](../../images/stream_iterator.png)

会输出：

```bash
10,20,30,40,50,60,70,80,90
```



## 仿函数

重载了 () 操作符的类，使得类对象可以像函数那样调用，叫仿函数。又叫**函数对象**。

示例1：

```c++
class MyAdd
{
public:
  int operator()(int a, int b) {
    return a + b;
  }
}

void test1
{
  cout << MyAdd()(4,5) << endl;
}
```

示例2：

```c++
class Print
{
public:
  void operator(int a) {
    cout << a << endl;
  }
}

void test2
{
  vector<int> v;
  v.push_back(1);
  v.push_back(3);
  v.push_back(5);
  for_each(v.begin(), v.end(), Print())
}
// 1
// 3
// 5
```

如果重载的 operator() 形参是一个参数，叫一元仿函数（unary functor）；

如果重载的 operator() 形参是两个参数，叫一元仿函数（binary functor）；



## 谓词

概念：

谓词是指普通函数或重载的 operator() 返回值是 bool 类型的函数对象（仿函数）。如果 operator 接受一个参数，那么叫做一元谓词；如果接受两个参数，那么叫做二元谓词；谓词可作为一个判断式。

```c++
class GreaterThanFile
{
public:  	
  // 一元谓词
  bool operator()(int num) {
    return num > 5;
  }
}

// 二元谓词
bool compare(int a, int b) {
  return a > b;
}

vector<int>::iterator it = find_if(vec.begin(), vec.end(), compare);
auto it2 = find_if(vec.begin(), vec.end(), GreaterThanFile())
```



## 参考资料

- [C++标准库 体系结构与内核分析 - 候捷](https://www.bilibili.com/video/BV1yo4y1o7yA?p=1)











